#!/bin/bash

# Create csv file of completed items from daily notes by counting lines between #DONE# marks
touch ~/Desktop/word_count.txt

# Using a for loop and multiple sed arguments to amend the file (takes longer)
for f in ./*; do { printf '%s ' "$f"; sed -n '/DONE/,/DONE/p' "$f" | wc -l; } >> ~/Desktop/word_count.txt; done

# Make multiple whitespace into 1 whitespace, to csv
awk '{$1=$1}1' ~/Desktop/word_count.txt > ~/Desktop/word_count.csv

# Replace "md " with "md,"
perl -pi -w -e  's/md\s/md,/g;' ~/Desktop/word_count.csv

# Add column names
echo -e "date,count\n$(cat ~/Desktop/word_count.csv)" > ~/Desktop/word_count.csv

# delete txt file
rm ~/Desktop/word_count.txt

# Run R script
Rscript ~/Google_Drive/Code/R/done_count.R
